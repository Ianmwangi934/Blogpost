{% extends "customer/layout.html" %}
{% block body %}
    <h1>Flight Data for {{ airline.name }}</h1>
    <div id="flights">Loading flight data.....
        {% if flight_data.error %}
            <p>Error loading flight data: {{flight_data.error}}</p>
        {% elif flight_data %}
            {% if flight_data|length > 0 %}
                <ul>
                    {% for flight in flight_data %}
                        <li>
                            Flight {{flight.flight.iata}}:
                            {{flight.departure.iata}} -> {{flight.arrival.iata}}<br>
                            (Status: {{flight.status}})
                            <!-- The link sends flight details to the booking view-->
                            <a href="{% url 'book_flight_view' %}?flight_number={{ flight.flight.iata }}&departure_airport={{airport_iata}}&arrival_airport={{flight.arrival.iata}}&airline_iata={{airline.iata_code}}">Book Flight</a>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No flight data available</p>
            {% endif %}
        {% else %}
                <p>Loading flight data .....</p>
        {% endif %}

    </div>
    
{% endblock %}